Correlation techniques for threat hunting. A mix of lookups, fault trees and statistical methods. Some need events from one pipeline;
multivariates need events from multiple pipelines which will require field normalization. 

| Category            | Type                          | Name                                                                                     |
|---------------------|-------------------------------|------------------------------------------------------------------------------------------|
| Asset Integrity     | Statistical                   |  new host                                                                                |
| Asset Integrity     | Statistical                   |  new service                                                                             |
| Asset Integrity     | Statistical                   |  new service port                                                                        |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by credential dumping                                     |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by exfil                                                  |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by remote access                                          |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by unusual DC logins                                      |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by unusual local administration activity                  |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by unusual local logins                                   |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by unusual user command activity                          |
| Multivariate        | Fault Tree                    | Abnormal process exit followed by user changes                                           |
| Network             | Fault Tree                    | ACL denies followed by accepts                                                           |
| Network             | Fault Tree                    | ACL denies from critical servers                                                         |
| Network             | Fault Tree                    | ACL denies from hypervisor                                                               |
| Network             | Fault Tree                    | ACL denies from ICS network                                                              |
| Multivariate        | Fault Tree                    | ACL Permitted Exploits                                                                   |
| Windows             | Entity / Relationship Anomaly | AD administration from a user workstation                                                |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by credential dumping                          |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by exfil                                       |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by remote access                               |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by unusual DC logins                           |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by unusual local administration activity       |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by unusual local logins                        |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by unusual user command activity               |
| Multivariate        | Fault Tree                    | Anomalous command shell activity followed by user changes                                |
| Fuzzing             | Statistical                   | anomalous errors                                                                         |
| Multivariate        | Fault Tree                    | Anomalous java process followed by credential dumping                                    |
| Multivariate        | Fault Tree                    | Anomalous java process followed by exfil                                                 |
| Multivariate        | Fault Tree                    | Anomalous java process followed by remote access                                         |
| Multivariate        | Fault Tree                    | Anomalous java process followed by unusual DC logins                                     |
| Multivariate        | Fault Tree                    | Anomalous java process followed by unusual local administration activity                 |
| Multivariate        | Fault Tree                    | Anomalous java process followed by unusual local logins                                  |
| Multivariate        | Fault Tree                    | Anomalous java process followed by unusual user command activity                         |
| Multivariate        | Fault Tree                    | Anomalous java process followed by user changes                                          |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by credential dumping                            |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by exfil                                         |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by remote access                                 |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by unusual DC logins                             |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by unusual local administration activity         |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by unusual local logins                          |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by unusual user command activity                 |
| Multivariate        | Fault Tree                    | Anomalous JVM command activity followed by user changes                                  |
| Windows             | Entity / Relationship Anomaly | Anomalous login to a DC                                                                  |
| Linux               | Entity / Relationship Anomaly | Anomalous manual command activity                                                        |
| Multivariate        | Fault Tree                    | Anomalous new process followed by credential dumping                                     |
| Multivariate        | Fault Tree                    | Anomalous new process followed by exfil                                                  |
| Multivariate        | Fault Tree                    | Anomalous new process followed by remote access                                          |
| Multivariate        | Fault Tree                    | Anomalous new process followed by unusual DC logins                                      |
| Multivariate        | Fault Tree                    | Anomalous new process followed by unusual local administration activity                  |
| Multivariate        | Fault Tree                    | Anomalous new process followed by unusual local logins                                   |
| Multivariate        | Fault Tree                    | Anomalous new process followed by unusual user command activity                          |
| Multivariate        | Fault Tree                    | Anomalous new process followed by user changes                                           |
| Multivariate        | Fault Tree                    | Anomalous new service followed by credential dumping                                     |
| Multivariate        | Fault Tree                    | Anomalous new service followed by exfil                                                  |
| Multivariate        | Fault Tree                    | Anomalous new service followed by remote access                                          |
| Multivariate        | Fault Tree                    | Anomalous new service followed by unusual DC logins                                      |
| Multivariate        | Fault Tree                    | Anomalous new service followed by unusual local administration activity                  |
| Multivariate        | Fault Tree                    | Anomalous new service followed by unusual local logins                                   |
| Multivariate        | Fault Tree                    | Anomalous new service followed by unusual user command activity                          |
| Multivariate        | Fault Tree                    | Anomalous new service followed by user changes                                           |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by credential dumping                        |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by exfil                                     |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by remote access                             |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by unusual DC logins                         |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by unusual local administration activity     |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by unusual local logins                      |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by unusual user command activity             |
| Multivariate        | Fault Tree                    | Anomalous PHP interpreter activity followed by user changes                              |
| Network             | Statistical                   | Anomalous port activity                                                                  |
| Multivariate        | Fault Tree                    | Anomalous process activity followed by high rate HTTPS activity                          |
| Windows             | Entity / Relationship Anomaly | Anomalous RDP login                                                                      |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by credential dumping                                 |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by exfil                                              |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by remote access                                      |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by unusual DC logins                                  |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by unusual local administration activity              |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by unusual local logins                               |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by unusual user command activity                      |
| Multivariate        | Fault Tree                    | Anomalous script activity followed by user changes                                       |
| Network             | Statistical                   | Anomalous user agents on ports 80/443                                                    |
| Windows             | Entity / Relationship Anomaly | Anomalous VPN login                                                                      |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by credential dumping                     |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by exfil                                  |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by remote access                          |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by unusual DC logins                      |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by unusual local administration activity  |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by unusual local logins                   |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by unusual user command activity          |
| Multivariate        | Fault Tree                    | Anomalous web server command activity followed by user changes                           |
| Malware             | Lookups                       | anonymous dns domains                                                                    |
| Cloud               | Lookups                       | AssumedRole compromise                                                                   |
| Multivariate        | Fault Tree                    | attack followed by configuration change                                                  |
| Credentialed Access | Fault Tree                    | Auth Failures Followed By Success                                                        |
| Credentialed Access | Lookups                       | authentication by user on PTO                                                            |
| Credentialed Access | Fault Tree                    | authorization failures followed by privilege change                                      |
| Data Layer          | Fault Tree                    | authorization failures followed by success                                               |
| Credentialed Access | Fault Tree                    | authorization failures followed by user changes                                          |
| Malware             | Fault Tree                    | AV update followed by malware detect                                                     |
| Windows             | Entity / Relationship Anomaly | Command prompt activity by a user                                                        |
| Cloud               | Lookups                       | Connection from a foreign container                                                      |
| Cloud               | Lookups                       | Connection from a foreign instance                                                       |
| Cloud               | Lookups                       | Connection to a foreign data layer                                                       |
| Cloud               | Lookups                       | Connection to a foreign message queue                                                    |
| Cloud               | Lookups                       | Connection to a foreign S3 bucket                                                        |
| Multivariate        | Fault Tree                    | corroborated exploit activity                                                            |
| Malware             | Fault Tree                    | corroborated malware detections                                                          |
| Multivariate        | Fault Tree                    | Credential dumping followed by credential dumping                                        |
| Multivariate        | Fault Tree                    | Credential dumping followed by exfil                                                     |
| Multivariate        | Fault Tree                    | Credential dumping followed by remote access                                             |
| Multivariate        | Fault Tree                    | Credential dumping followed by unusual DC logins                                         |
| Multivariate        | Fault Tree                    | Credential dumping followed by unusual local administration activity                     |
| Multivariate        | Fault Tree                    | Credential dumping followed by unusual local logins                                      |
| Multivariate        | Fault Tree                    | Credential dumping followed by unusual user command activity                             |
| Multivariate        | Fault Tree                    | Credential dumping followed by user changes                                              |
| Malware             | Fault Tree                    | critical malware outbreak                                                                |
| Network             | Lookups                       | darknet traffic                                                                          |
| Multivariate        | Fault Tree                    | database errors followed by exfil                                                        |
| Multivariate        | Fault Tree                    | database errors followed by remote login                                                 |
| Data Layer          | Fault Tree                    | database failures followed by success                                                    |
| Linux               | Entity / Relationship Anomaly | database login from unusual source                                                       |
| Multivariate        | Lookups                       | desktop user agent from EC2 address                                                      |
| Malware             | Fault Tree                    | distributed malware activity                                                             |
| Windows             | Entity / Relationship Anomaly | Domain admin login from a member server                                                  |
| Windows             | Entity / Relationship Anomaly | Domain admin login from a user workstation                                               |
| Windows             | Entity / Relationship Anomaly | Domain controller access from a user workstation                                         |
| Multivariate        | Fault Tree                    | enumeration followed by exploit                                                          |
| Fuzzing             | Fault Tree                    | error burst                                                                              |
| Fuzzing             | Fault Tree                    | Error bursts                                                                             |
| Fuzzing             | Statistical                   | Error rate changes                                                                       |
| Fuzzing             | Fault Tree                    | error spike                                                                              |
| Fuzzing             | Fault Tree                    | error storm                                                                              |
| Fuzzing             | Fault Tree                    | error stream                                                                             |
| Network             | Fault Tree                    | excessive ACL denies                                                                     |
| Network             | Statistical                   | excessive process activity                                                               |
| Data Layer          | Fault Tree                    | excessive schema or configuration change failures followed by success                    |
| Windows             | Entity / Relationship Anomaly | Exchange server administration from a user workstation                                   |
| Multivariate        | Lookups                       | Exploit / Vuln Correlation                                                               |
| Multivariate        | Fault Tree                    | Exploit event followed by shellcode activity                                             |
| Multivariate        | Fault Tree                    | Exploit followed by admin login                                                          |
| Multivariate        | Fault Tree                    | exploit followed by anomalous activity                                                   |
| Multivariate        | Fault Tree                    | Exploit followed by credential dumping                                                   |
| Multivariate        | Fault Tree                    | Exploit followed by exfil                                                                |
| Multivariate        | Fault Tree                    | exploit followed by flow activity to attacker                                            |
| Multivariate        | Fault Tree                    | exploit followed by flows to attacker                                                    |
| Multivariate        | Fault Tree                    | Exploit Followed by Malware                                                              |
| Multivariate        | Fault Tree                    | exploit followed by new flow activity                                                    |
| Multivariate        | Fault Tree                    | Exploit followed by password dumping                                                     |
| Multivariate        | Fault Tree                    | Exploit followed by remote access                                                        |
| Multivariate        | Fault Tree                    | exploit followed by service fail                                                         |
| Multivariate        | Fault Tree                    | Exploit Followed by Suspicious Host Activity                                             |
| Multivariate        | Fault Tree                    | Exploit followed by unusual DC logins                                                    |
| Multivariate        | Fault Tree                    | Exploit followed by unusual local administration activity                                |
| Multivariate        | Fault Tree                    | Exploit followed by unusual local logins                                                 |
| Multivariate        | Fault Tree                    | Exploit followed by unusual user command activity                                        |
| Multivariate        | Fault Tree                    | Exploit followed by user changes                                                         |
| Multivariate        | Fault Tree                    | exploit followed by watchlist activity                                                   |
| Multivariate        | Fault Tree                    | Exploit or malware followed by high rate HTTPS activity                                  |
| Multivariate        | Correlations                  | Exploitation coinciding with container host remote flows                                 |
| Multivariate        | Correlations                  | Exploitation coinciding with hypervisor remote flows                                     |
| Multivariate        | Correlations                  | Exploitation followed by anomalous credential or key use                                 |
| Credentialed Access | Fault Tree                    | failed logins followed by password change                                                |
| Asset integrity     | Lookups                       | feral host - EOL software                                                                |
| Asset integrity     | Lookups                       | feral host - patching blocked by version pinning                                         |
| Asset integrity     | Lookups                       | feral host - security agent stopped                                                      |
| Asset integrity     | Lookups                       | feral host - stopped sending telemetry                                                   |
| Asset integrity     | Lookups                       | feral host - unmanaged or unpatched recently                                             |
| Windows             | Entity / Relationship Anomaly | Firewall login from user workstation                                                     |
| Malware             | Lookups                       | fresh malware detection                                                                  |
| Credentialed Access | Lookups                       | Geographic Auth Anomalies                                                                |
| Network             | Lookups                       | Geographic detection                                                                     |
| Network             | Fault Tree                    | Geometric detection                                                                      |
| Network             | Statistical                   | high rate connection activity                                                            |
| Network             | Statistical                   | high rate email activity                                                                 |
| Asset Integrity     | Fault Tree                    | host gone dark                                                                           |
| Cloud               | Correlations                  | IAM user change followed by Cloudtrail tampering                                         |
| Cloud               | Correlations                  | IAM user change followed by new service usage                                            |
| Cloud               | Correlations                  | IAM user change followed by rogue workload                                               |
| Cloud               | Lookups                       | IAM user changes from a foreign EC2 instance or container                                |
| Cloud               | Lookups                       | IAM user changes from an EC2 instance or container                                       |
| Network             | Statistical                   | increasing ACL denies                                                                    |
| Malware             | Statistical                   | increasing backdoor activity                                                             |
| Credentialed Access | Statistical                   | increasing brute force                                                                   |
| Credentialed Access | Statistical                   | increasing lockouts                                                                      |
| Malware             | Statistical                   | increasing malware outbreak                                                              |
| Network             | Statistical                   | increasing port activity                                                                 |
| Fuzzing             | Fault Tree                    | increasing rate of an event                                                              |
| Exploitation        | Statistical                   | increasing rates of 500s                                                                 |
| Fuzzing             | Fault Tree                    | increasing rates of errors                                                               |
| Fuzzing             | Fault Tree                    | increasing rates of errors from a network service                                        |
| Linux               | Entity / Relationship Anomaly | Local admin login from a user workstation                                                |
| Windows             | Entity / Relationship Anomaly | Login from one DC to another                                                             |
| Windows             | Entity / Relationship Anomaly | Login from one member server to another                                                  |
| Windows             | Entity / Relationship Anomaly | Login from one user workstation to another                                               |
| Network             | Fault Tree                    | long duration connection activity                                                        |
| Network             | Fault Tree                    | Long flows                                                                               |
| Asset Integrity     | Fault Tree                    | long reboot - system offline                                                             |
| Malware             | Fault Tree                    | macro followed by dns lookup and new process                                             |
| Multivariate        | Fault Tree                    | Malware coinciding with ja3 detect                                                       |
| Multivariate        | Fault Tree                    | Malware detection followed by credential dumping                                         |
| Multivariate        | Fault Tree                    | Malware detection followed by exfil                                                      |
| Multivariate        | Fault Tree                    | Malware detection followed by remote access                                              |
| Multivariate        | Fault Tree                    | Malware detection followed by unusual DC logins                                          |
| Multivariate        | Fault Tree                    | Malware detection followed by unusual local administration activity                      |
| Multivariate        | Fault Tree                    | Malware detection followed by unusual local logins                                       |
| Multivariate        | Fault Tree                    | Malware detection followed by unusual user command activity                              |
| Multivariate        | Fault Tree                    | Malware detection followed by user changes                                               |
| Malware             | Fault Tree                    | malware outbreak                                                                         |
| Exploitation        | Fault Tree                    | Multiple Exploit Types Against Single Target                                             |
| Malware             | Fault Tree                    | multiple malware detections                                                              |
| Malware             | Fault Tree                    | network flows with no corresponding endpoint flows                                       |
| Fuzzing             | Fault Tree                    | New / unique errors                                                                      |
| Malware             | Lookups                       | new dns domains                                                                          |
| Credentialed Access | Statistical                   | new user creation, login followed by sniffing and user deletion                          |
| Multivariate        | Fault Tree                    | Pacu followed by shell export                                                            |
| Cloud               | Fault Tree                    | Passing a role to a new Lambda function, then triggering it with DynamoDB                |
| Exploitation        | Fault Tree                    | Pivoting Via Exploits                                                                    |
| Windows             | Entity / Relationship Anomaly | Powershell commands by a user                                                            |
| Malware             | Statistical                   | programmatic outbound traffic                                                            |
| Exploitation        | Fault Tree                    | proxy alert followed by exploit detect                                                   |
| Windows             | Entity / Relationship Anomaly | psexec activity from a user workstation                                                  |
| Fuzzing             | Fault Tree                    | Rare errors                                                                              |
| Windows             | Entity / Relationship Anomaly | Registry access from a user workstation                                                  |
| Malware             | Statistical                   | repeat malware activity                                                                  |
| Exploitation        | Fault Tree                    | repeated exploit activity                                                                |
| Malware             | Fault Tree                    | repeated malware activity                                                                |
| Malware             | Lookups                       | requests to new domains                                                                  |
| Asset integrity     | Lookups                       | rogue host                                                                               |
| Exploitation        | Lookups                       | scan not sourcing from Qualys instance                                                   |
| Network             | Lookups                       | scan not sourcing from Qualys instance                                                   |
| Network             | Fault tree                    | scanner activity                                                                         |
| Network             | Statistical                   | scheduled connection activity                                                            |
| Asset Integrity     | Fault Tree                    | service gone dark                                                                        |
| Multivariate        | Fault Tree                    | shell commands followed by exfil                                                         |
| Multivariate        | Fault Tree                    | shell commands followed by remote login                                                  |
| Exploitation        | Fault Tree                    | single host doing many different attacks                                                 |
| Credentialed Access | Fault Tree                    | single host doing multiple username authentications                                      |
| Exploitation        | Fault Tree                    | single host doing one attack on many targets                                             |
| Windows             | Entity / Relationship Anomaly | SQL server administration from a user workstation                                        |
| Linux               | Entity / Relationship Anomaly | SSH login from unusual source                                                            |
| Malware             | Lookups                       | stale malware detection                                                                  |
| Credentialed Access | Fault Tree                    | successful auth preceded by scan                                                         |
| Credentialed Access | Fault Tree                    | successful brute force                                                                   |
| Data Layer          | Fault Tree                    | successful user changes preceded by schema or configuration change failures              |
| Network             | Statistical                   | Suspicious connection between hosts that do not normally talk                            |
| Linux               | Entity / Relationship Anomaly | system commands from  a non-ops user                                                     |
| Windows             | Entity / Relationship Anomaly | System tool usage by a user                                                              |
| Exploitation        | Fault Tree                    | Targeted Exploits                                                                        |
| Network             | Fault Tree                    | targeted external scan                                                                   |
| Exploitation        | Fault Tree                    | targeted scan followed by targeted exploit                                               |
| Network             | Lookups                       | Threat Intel IP activity                                                                 |
| Network             | Statistical                   | Traffic volume or shape change                                                           |
| Network             | Lookups                       | Unauthorized port activity                                                               |
| Network             | Lookups                       | Unauthorized Scan                                                                        |
| Exploitation        | Fault Tree                    | Unauthorized vuln scan                                                                   |
| Malware             | Lookups                       | unknown malware classification                                                           |
| Asset integrity     | Lookups                       | Unpatched instance, critical vuln                                                        |
| Asset integrity     | Lookups                       | Unpatched instance, long term                                                            |
| Asset integrity     | Lookups                       | Unpatched instance, multiple vulns                                                       |
| Network             | Statistical                   | Unusual ACL Accepts                                                                      |
| Network             | Statistical                   | Unusual ACL Denies                                                                       |
| Credentialed Access | Statistical                   | Unusual auth to compliance assets                                                        |
| Credentialed Access | Statistical                   | Unusual failed auth to compliance assets                                                 |
| Network             | Statistical                   | Unusual firewall accepts                                                                 |
| Network             | Statistical                   | Unusual firewall denies                                                                  |
| Network             | Statistical                   | Unusual flows                                                                            |
| Network             | Statistical                   | Unusual proxy denies                                                                     |
| Network             | Statistical                   | Unusual scan activity                                                                    |
| Multivariate        | Fault Tree                    | user account creation followed by  configuration change                                  |
| Network             | Fault tree                    | volumetric data transfer activity                                                        |
| Network             | Lookups                       | Watchlist IP activity                                                                    |
| Network             | Lookups                       | watchlisted events                                                                       |
| Exploitation        | Fault Tree                    | web anomaly followed by shell activity                                                   |
| Multivariate        | Fault Tree                    | Web attack followed by exfil                                                             |
| Multivariate        | Fault Tree                    | Web attack followed by netcat activity                                                   |
| Multivariate        | Fault Tree                    | Web attack followed by remote login                                                      |
| Exploitation        | Fault Tree                    | web attack followed by shell activity                                                    |
| Multivariate        | Fault Tree                    | Web attack followed by user changes                                                      |
| Exploitation        | Fault Tree                    | web exploit, targeted                                                                    |
| Windows             | Entity / Relationship Anomaly | WMI activity from a user workstation                                                     |
