import requests
import os
import sys
import socket
import re


#tested True =  exploit work


headers = {
    'User-Agent' : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    'Accept-Language': 'en-US,en;q=0.5',
    'Connection': 'keep-alive',
}

url = input("\n\n[*] enter url: ")



#joomla
#wordpress
#drupal
#prestashop
#opencart
#magento

def detect_cms():
    content=requests.get(url,headers).text
    #         joomla           #
    if  re.search(re.compile(r'<script type=\"text/javascript\" src=\"/media/system/js/mootools.js\"></script>|/media/system/js/|com_content|Joomla!'), content):
        print ('------------------------------------------------')
        print (' looking for cms')
        print (' CMS : Joomla')
        print ('------------------------------------------------')

    #        wordpress         #
    elif re.search(re.compile(r'wp-content|wordpress|xmlrpc.php'), content):
        print ('------------------------------------------------')
        print (' looking for cms')
        print (' CMS : Wordpress')
        print ('------------------------------------------------')

    #        drupal            #
    elif re.search(re.compile(r'Drupal|drupal|sites/all|drupal.org'), content):
        print ('------------------------------------------------')
        print (' looking for cms')
        print (' CMS : Drupal')
        print ('------------------------------------------------')

    #        Prestashop        #
    elif re.search(re.compile(r'Prestashop|prestashop'), content):
        print ('------------------------------------------------')
        print (' looking for cms')
        print (' CMS : Prestashop')
        print ('------------------------------------------------')

    #          OpenCart        #
    elif re.search(re.compile(r'route=product|OpenCart|route=common|catalog/view/theme'), content):
        print ('------------------------------------------------')
        print (' looking for cms')
        print (' CMS : OpenCart')
        print ('------------------------------------------------')

    #          Magento         #
    elif re.search(re.compile(r'Log into Magento Admin Page|name=\"dummy\" id=\"dummy\"|Magento'), content):
        print ('------------------------------------------------')
        print (' looking for cms')
        print (' CMS : Magento')
        print ('------------------------------------------------')

    #          Unknown         #
    else:
        print ('------------------------------------------------')
        print (' looking for cms')
        print (' CMS : Unknown' )
        print ('------------------------------------------------')

detect_cms()